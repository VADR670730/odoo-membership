<?xml version="1.0"?>
<odoo>
    <record id="welcome_mail_template_automation" model="mail.template">
      <field name="name">V채lkomstmail Automation</field>
      <field name="model_id" ref="base.model_res_partner" />
      <field name="subject">V채lkommen ${object.name}</field>
      <field name="email_to">${object.email}</field>
      <field name="lang">${object.lang}</field>
      <field name="body_html">
          Hej ${object.name}, du kommer h채rmed f책 stadsteaterns nyhetsbrev.
      </field>
    </record>
    
    <record id="test_rule_on_update_welcome_message" model="base.automation">
      <field name="name">Base Automation: send welcome email</field>
      <field name="model_id" ref="base.model_res_partner" />
      <field name="template_id" ref="welcome_mail_template_automation" />
      <field name="state">email</field>
      <field name="trigger_field_ids" eval="[(4,ref('membership.field_res_partner__membership_state'))]" />
      <field name="trigger">on_write</field>
      <field name="active" eval="True" />
      <field name="filter_domain">[["membership_state","in",["invoiced","paid","free"]]]</field>
      <field name="filter_pre_domain">[]</field>
    </record>
    
    <record id="test_rule_on_create_contact_membership" model="base.automation">
      <field name="name">Base Automation: make new contact a member</field>
      <field name="model_id" ref="base.model_res_partner" />
      <field name="state">code</field>
      <field name="code">
            if records:
                records.write({'membership_state': 'free'})
                records.write({'free_member': True})
      </field>
      <field name="trigger">on_create</field>
      <field name="active" eval="True" />
      <field name="filter_pre_domain">[]</field>
    </record>
</odoo>
