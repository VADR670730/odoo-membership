<?xml version="1.0"?>
<odoo>
        
  <record id="res_partner_view_search_inherit_taxid" model="ir.ui.view">
    <field name="name">res.partner.view.search.inherit.taxid</field>
    <field name="model">res.partner</field>
    <field name="inherit_id" ref="base.view_res_partner_filter" />
    <field name="arch" type="xml">
      <filter name="inactive" position="before">
        <!--
             <filter string="Tax ID" name="vat" domain="[('is_company','=',True)]" />
             <filter string="Person Number" name="personnumber" domain="[('is_company','=',False)]"/>
             <filter string="City" name="city" domain="[('is_company','=',True)]"/>
        -->
        <filter string="Company" name="is_company" domain="[('insurance_company_type','=','company')]" />
        <filter string="Fellowship" name="is_fellowship" domain="[('insurance_company_type','=','fellowship')]" />
        <filter string="Accommodator" name="is_accommodator" domain="[('insurance_company_type','=','accommodator')]" />
        <filter string="Male" name="gender" domain="[('gender','=','man')]" />
        <filter string="Female" name="gender" domain="[('gender','=','woman')]" />
      </filter>
    </field>
  </record>
  
  <record id="view_member_tree" model="ir.ui.view">
    <field name="name">member.tree</field>
    <field name="model">res.partner</field>
    <field eval="99" name="priority"/>
    <field name="arch" type="xml">
        <tree string="Members">
            <field name="insurance_company_type" />
            <field name="fellowship_id" />
            <field name="insurance_company_id" />
            <field name="name" />
            <field name="phone"/>
            <field name="email"/>
            <field name="user_id" invisible="1"/>
            <field name="is_company" invisible="1"/>
            <field name="country_id" invisible="1"/>
            <field name="parent_id" invisible="1"/>
            <field name="active" invisible="1"/>
            <field name="org_prn" string="Org/pers-nummer"/>
            <field name="city" />
        </tree>
    </field>
  </record>
  
  <record id="view_partners_form_insurance" model="ir.ui.view">
        <field name="name">view.res.partner.form.insurance</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <field name="company_registry" position="replace">
                <field name="company_registry" string="Company Registry" attrs="{'invisible': [('is_company','=',False)]}"/>
            </field>
            <field name="state_id" position="replace"/>
            <field name="zip" position="replace"/>
            <field name="city" position="replace">
                <field name="zip" placeholder="ZIP" style="width: 20%"/>                        
                <field name="city" placeholder="City" style="width: 40%" />
                <field name="state_id" invisible="1" />
            </field>
        </field>
  </record>
        
        
  
  <record id="view_partners_form_crm1" model="ir.ui.view">
    <field name="name">partner.form.insurance.crm.inherit</field>
    <field name="model">res.partner</field>
    <field name="inherit_id" ref="crm.view_partners_form_crm1" />
    <field name="arch" type="xml">
      <button name="%(crm.crm_lead_opportunities)d" position="before">
        <button class="oe_stat_button" name="company_button" type="object" icon="fa-industry" context="{'partner_id': active_id, 'partner_name': name}">
          <field name="count_company" widget="statinfo" />
        </button>
        <button class="oe_stat_button" name="accommodator_button" type="object" icon="fa-group" context="{'partner_id': active_id, 'partner_name': name}" attrs="{'invisible': [('company_type', '!=', 'company')]}">
          <field name="count_accommodator" widget="statinfo" />
        </button>

      </button>
    </field>
  </record>
  <record id="view_partner_form" model="ir.ui.view">
    <field name="name">partner.form.insurance.inherited</field>
    <field name="model">res.partner</field>
    <field name="inherit_id" ref="base.view_partner_form" />
    <field name="arch" type="xml">
      <field name="company_type" position="replace">
        <field name="company_type" invisible="1" />
        <field name="insurance_company_type" options="{'horizontal': true}" widget="radio" />
        <!-- class="oe_edit_only"  -->
      </field>
      <field name="child_ids" position="attributes">
        <attribute name="context">{'search_default_is_company':False,'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_supplier': supplier, 'default_customer': customer, 'default_lang': lang, 'default_user_id': user_id}</attribute>
      </field>
      <field name="parent_id" position="attributes">
        <attribute name="attrs">{'invisible': [('insurance_company_type','in', ['fellowship'])]}</attribute>
      </field>
      <!--
           attrs=mode="kanban" context="{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_supplier': supplier, 'default_customer': customer, 'default_lang': lang, 'default_user_id': user_id}">
      -->
      <div class="oe_title" position="after">
        <group>
          <group string="Count companies" name="companies" priority="2" attrs="{'invisible': [('insurance_company_type', '!=', 'fellowship')]}">
            <field name="count_co_life_permission" />
            <field name="count_co_property_permission" />
            <field name="count_co_property_life_permission" />
          </group>
        </group>
        <group>
          <group string="Count licenced accommodators" name="licenced_ac" priority="2" attrs="{'invisible': [('insurance_company_type', 'not in', ['fellowship','company'])]}">
            <field name="count_ac_life_licence" />
            <field name="count_ac_property_licence" />
            <field name="count_ac_property_life_licence" />
          </group>
          <group string="Count employed accommodators" name="employed" priority="3" attrs="{'invisible': [('insurance_company_type', 'not in', ['fellowship','company'])]}">
            <field name="count_ac_life" />
            <field name="count_ac_property" />
            <field name="count_ac_property_life" />
          </group>
        </group>
      </div>
      <field name="vat" position="before">
        <field name="personnumber" placeholder="10 or 12 digital" attrs="{'invisible': [('company_type', '=', 'company')]}" />
        <field name="company_role" widget="many2one_tag" attrs="{'invisible': [('insurance_company_type', '!=', 'person'),('insurance_company_type', '!=', 'accommodator'),]}" />
        <field name="gender" widget='radio' options="{'horizontal': true}" attrs="{'invisible': [('company_type', '=', 'company')]}"/>
        <field name="liability_insurance_permission" widget="many2many_tags" attrs="{'invisible': [('insurance_company_type', '=', 'person')]}" />
        <field name="liability_insurance" widget="many2many_tags" attrs="{'invisible': [('insurance_company_type', '=', 'person')]}" />
        <field name="revenue" attrs="{'invisible': [('insurance_company_type', 'in', ['person','accommodator'])]}" />
        <field name="revenue_property" attrs="{'invisible': [('insurance_company_type', 'in', ['person','accommodator'])]}" />
        <field name="revenue_life" attrs="{'invisible': [('insurance_company_type', 'in', ['person','accommodator'])]}" />
      </field>
      <field name="vat" position="attributes">
        <attribute name="attrs">{'readonly': [('parent_id','!=',False)], 'invisible': [('company_type','!=','company')]}</attribute>
      </field>
      <field name="function" position="attributes">
        <attribute name="invisible">1</attribute>
      </field>
      <field name="title" position="attributes">
        <attribute name="invisible">1</attribute>
      </field>
      <field name="website" position="attributes">
        <attribute name="invisible">1</attribute>
      </field>
      <button name="company_button" position="attributes">
        <attribute name="attrs">{'invisible': [('insurance_company_type', 'not in', ['fellowship'])]}</attribute>
      </button>
    </field>
  </record>

  <record id="action_all_form" model="ir.actions.act_window">
    <field name="name">All</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('insurance_company_type','!=','person')]</field>
    <field name="view_id" ref="base.res_partner_kanban_view" />
    <field name="act_window_id" ref="membership.action_membership_members" />
    <field name="search_view_id" ref="base.view_res_partner_filter" />
    <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('membership_insurance.view_member_tree')}),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('base.res_partner_kanban_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('base.view_partner_form')})]"/>
  </record>
  <record id="action_fellowship_form" model="ir.actions.act_window">
    <field name="name">Fellowship</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('insurance_company_type','=', 'fellowship')]</field>
    <field name="view_id" ref="base.res_partner_kanban_view" />
    <field name="act_window_id" ref="membership.action_membership_members" />
    <field name="search_view_id" ref="base.view_res_partner_filter" />
    <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('membership_insurance.view_member_tree')}),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('base.res_partner_kanban_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('base.view_partner_form')})]"/>
  </record>
  <record id="action_accommodator_form" model="ir.actions.act_window">
    <field name="name">Accommodator</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('insurance_company_type','=', 'accommodator')]</field>
    <field name="view_id" ref="base.res_partner_kanban_view" />
    <field name="act_window_id" ref="membership.action_membership_members" />
    <field name="search_view_id" ref="base.view_res_partner_filter" />
    <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('membership_insurance.view_member_tree')}),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('base.res_partner_kanban_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('base.view_partner_form')})]"/>
  </record>
  <record id="action_company_form" model="ir.actions.act_window">
    <field name="name">Company</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('insurance_company_type','=', 'company')]</field>
    <field name="view_id" ref="base.res_partner_kanban_view" />
    <field name="act_window_id" ref="membership.action_membership_members" />
    <field name="search_view_id" ref="base.view_res_partner_filter" />
    <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('membership_insurance.view_member_tree')}),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('base.res_partner_kanban_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('base.view_partner_form')})]"/>
  </record>
  
  <menuitem id="res_partner_menu_all" name="All" parent="membership.menu_membership" action="action_all_form" sequence="99" />
  <menuitem id="res_partner_menu_fellowship" name="Fellowship" parent="membership.menu_membership" action="action_fellowship_form" sequence="2" />
  <menuitem id="res_partner_menu_company" name="Company" parent="membership.menu_membership" action="action_company_form" sequence="3" />
  <menuitem id="res_partner_menu_accommodator" name="Accommodator" parent="membership.menu_membership" action="action_accommodator_form" sequence="4" />
  
 
</odoo>
